<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Students Corner</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
<header class="bg-[#0f172a] text-white shadow-md border-b-2 border-[#FFD700] fixed top-0 left-0 w-full z-50"> 
  <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center py-4">
       <div class="flex items-center">
         <img src="./images/Academy-logo.png" class="w-16 h-16 md:w-24 md:h-24" alt="School Logo">
        <div class="">
          <div class="text-2xl font-bold ml-2 md:text-3xl">JOY JUNIOR ACADEMY</div>
          <p class="text-sm text-gray-300 ml-2">BUNGOMA, KENYA</p>
        </div>  
       </div>
      <!-- Desktop Nav -->
      <div class="hidden md:flex items-center space-x-6">
        <a href="./index.html" class="hover:text-[#FFD700]">Home</a>
        <div class="relative group">
          <button class="text-white hover:text-[#FFD700] focus:outline-none">
            About
          </button>
          <div class="absolute left-0 mt-2 w-48 bg-white border rounded shadow-lg 
                      opacity-0 group-hover:opacity-100 
                      invisible group-hover:visible 
                      transition-all duration-300 z-50">
            <a href="./school.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Our School</a>          
            <a href="./staff.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Staff</a>
            <a href="./student.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Students corner</a>
            <a href="./career.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Careers</a>
            <a href="./alumni.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Alumni</a>
            <a href="./gallery.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Gallery</a>
            <a href="./pastoral.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Pastoral Care</a>
          </div>
        </div>
         <div class="relative group">
          <button class="text-white hover:text-[#FFD700] focus:outline-none">
            Services
          </button>
          <div class="absolute left-0 mt-2 w-48 bg-white border rounded shadow-lg 
                      opacity-0 group-hover:opacity-100 
                      invisible group-hover:visible 
                      transition-all duration-300 z-50">
            <a href="./feeding.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Feeding Program</a>
            <a href="./daycare.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Daycare</a>
            <a href="./counselling.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Counselling</a>
            <a href="./tours.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Tours</a>
            <a href="./clubs.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Clubs</a> 
          </div>
        </div>
         <div class="relative group">
          <button class="text-white hover:text-[#FFD700] focus:outline-none">
            Academics
          </button>
          <div class="absolute left-0 mt-2 w-48 bg-white border rounded shadow-lg 
                      opacity-0 group-hover:opacity-100 
                      invisible group-hover:visible 
                      transition-all duration-300 z-50">
            <a href="./academic.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Academic results</a>
            <a href="./cbc.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">CBC Curriculum</a>
            <a href="./practicals.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Practical Lessons</a>
            <a href="./competency.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Competency Areas</a>
            <a href="./club.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Clubs</a>
            <a href="./graduation.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Graduation</a>
          </div>
        </div>
          <div class="relative group">
          <button class="text-white hover:text-[#FFD700] focus:outline-none">
           Admissions
          </button>
          <div class="absolute left-0 mt-2 w-48 bg-white border rounded shadow-lg 
                      opacity-0 group-hover:opacity-100 
                      invisible group-hover:visible 
                      transition-all duration-300 z-50">
            <a href="./admissions.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Admission process</a>
            <a href="./fees.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">Fees</a>
            <a href="./questions.html" class="block px-4 py-2 text-gray-700 hover:bg-blue-100">FAQs</a>
          </div>
        </div>
         
        <a href="./events.html" class="hover:text-[#FFD700]">Events/News</a>
        <a href="./contact.html" class="hover:text-[#FFD700]">Contact Us</a>
        <a href="./login.html" class="px-4 py-1 border border-white rounded hover:bg-white hover:text-[#0A2342]">Login</a>
        <a href="./signup.html" class="px-4 py-1 bg-[#FFD700] text-[#0A2342] rounded hover:bg-yellow-400">Sign Up</a>
      </div>

      <!-- Mobile Toggle -->
      <button id="menu-toggle" class="md:hidden focus:outline-none">
        <svg class="w-9 h-9" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Side Menu -->
<div id="mobile-menu"
  class="fixed top-0 right-0 w-3/5 h-full bg-[#0A2342] text-white shadow-lg z-50 transform translate-x-full transition-transform duration-300 ease-in-out md:hidden">

  <div class="p-4">
    <!-- Close Button -->
    <button id="menu-close" class="mb-6 float-right focus:outline-none">
      <svg class="w-6 h-6" fill="none" stroke="white" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Links -->
    <nav class="mt-12 space-y-4">
      <a href="./index.html" class="block hover:text-[#FFD700]">Home</a>
      <div>
        <button class="mobile-dropdown-btn w-full text-left py-2 text-white hover:text-yellow-600">
          About us ▾ 
        </button>
          <div class="mobile-dropdown hidden pl-4 border-l border-gray-300">
            <a href="./school.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Our School</a>
            <a href="./staff.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Staff</a>
            <a href="./student.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Students corner</a>
            <a href="./career.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Careers</a>
            <a href="./alumni.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Alumni</a>
            <a href="./gallery.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Gallery</a>
            <a href="./pastoral.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Pastoral Care</a>
            <a href="./board.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Board of members</a>
          </div>
      </div>    
      <div>
        <button class="mobile-dropdown-btn w-full text-left py-2 text-white hover:text-yellow-600">
          Services ▾ 
        </button>
          <div class="mobile-dropdown hidden pl-4 border-l border-gray-300">
            <a href="./feeding.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Feeding Program</a>
            <a href="./daycare.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Daycare</a>
            <a href="./counselling.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Counselling</a>
            <a href="./tours.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Tours</a>
          </div>
      </div>
      <div>
        <button class="mobile-dropdown-btn w-full text-left py-2 text-white hover:text-yellow-600">
          Academics ▾ 
        </button>
          <div class="mobile-dropdown hidden pl-4 border-l border-gray-300">
             <a href="./academic.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Academic results</a>
            <a href="./cbc.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">CBC Curriculum</a>
            <a href="./practicals.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Practical Lessons</a>
            <a href="./competency.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Competency Areas</a>
            <a href="./tuition.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Holiday Tuition</a>
            <a href="./clubs.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Clubs</a>
            <a href="./graduation.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Graduation</a>
          </div>
      </div>
      <div>
        <button class="mobile-dropdown-btn w-full text-left py-2 text-white hover:text-yellow-600">
          Admissions ▾ 
        </button>
          <div class="mobile-dropdown hidden pl-4 border-l border-gray-300">
            <a href="./admissions.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Admission process</a>
            <a href="./fees.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">Fees</a>
            <a href="./questions.html" class="block px-4 py-2 text-yellow-400 hover:bg-blue-100">FAQs</a>
          </div>
      </div>    
      <a href="./events.html" class="block hover:text-[#FFD700]">Events/News</a>
      <a href="./contact.html" class="block hover:text-[#FFD700]">Contact Us</a>
      <div class="pt-2 border-t border-white mt-4 space-y-2">
        <a href="./login.html" class="block text-center border border-white py-2 rounded hover:bg-white hover:text-[#0A2342]">Login</a>
        <a href="./signup.html" class="block text-center bg-[#FFD700] text-[#0A2342] py-2 rounded hover:bg-yellow-400">Sign Up</a>
      </div>
    </nav>
  </div>
</div>

<section class="relative min-h-screen bg-[#0f172a] bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNIDAgMCAyMCAyMCAwIDIwIiBmaWxsPSIjZmZmIiBvcGFjaXR5PSIwLjA1Ii8+PC9zdmc+')] bg-repeat overflow-hidden">

  <!-- Floating Effects -->
  <div class="absolute top-10 left-10 w-16 h-16 bg-blue-400 opacity-20 rounded-full animate-pulse"></div>
  <div class="absolute bottom-24 right-10 w-24 h-24 bg-pink-400 opacity-20 rounded-full animate-bounce"></div>

  <!-- Content -->
  <div class="relative z-10 text-center px-4 md:px-12 max-w-5xl mx-auto pt-20 mt-20">
    <h1 class="text-4xl md:text-5xl font-bold italic text-white mb-4 drop-shadow-lg" style="font-family: 'Playfair Display', serif;">
      🎓 Student Corner
    </h1>
    <p class="text-lg md:text-xl text-gray-200 italic mb-6" style="font-family: 'Poppins', sans-serif;">
      Your daily academic dashboard – updated for parents in real-time!
    </p>

    <!-- Class Selector -->
    <div class="mb-10">
      <label for="classSelect" class="block text-white font-semibold text-lg mb-2">Select Class:</label>
      <select id="classSelect" class="text-yellow-600 rounded-full px-5 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400">
        <option value="grade1">Grade 1</option>
        <option value="grade2">Grade 2</option>
        <option value="grade3">Grade 3</option>
        <option value="grade4">Grade 4</option>
        <option value="grade5">Grade 5</option>
        <option value="grade6">Grade 6</option>
        <option value="grade7">Grade 7</option>
        <option value="grade8">Grade 8</option>
      </select>
    </div>

    <!-- Connection Status -->
    <div id="connectionStatus" class="mb-4 p-2 rounded hidden">
      <span id="statusText"></span>
    </div>

    <!-- Dashboard Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 px-4">
      <!-- Date -->
      <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 shadow-md text-white border border-white/10">
        <h3 class="text-xl font-semibold mb-2">⏱ Date</h3>
        <p id="current-date" class="text-lg italic text-gray-100">Loading...</p>
      </div>

      <!-- Assignments -->
      <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 shadow-md text-white border border-white/10">
        <h3 class="text-xl font-semibold mb-2">📝 Assignments</h3>
        <p id="assignments" class="text-lg italic text-gray-100">Loading...</p>
      </div>

      <!-- Notices -->
      <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 shadow-md text-white border border-white/10">
        <h3 class="text-xl font-semibold mb-2">📢 Notices</h3>
        <p id="notices" class="text-lg italic text-gray-100">Loading...</p>
      </div>
      
    <!-- Results -->
     <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 shadow-md text-white border border-white/10 hover:bg-white/20 transition">
       <h3 class="text-xl font-semibold mb-2">📊 Results</h3>
      
       <a href="./results.html" class="inline-block mt-2 bg-yellow-400 hover:bg-yellow-500 text-[#0f172a] font-semibold px-4 py-2 rounded-full shadow">
        View Results
       </a>
     </div>
    </div>
  

    <!-- CTA -->
    <div class="mt-12">
      <a href="#resources" class="bg-yellow-400 hover:bg-yellow-500 text-[#0f172a] font-semibold px-6 py-3 rounded-full shadow-md transition duration-300">
        Explore Resources
      </a>
    </div>
  </div>

  <!-- SVG Wave -->
  <div class="absolute bottom-0 left-0 right-0">
    <svg viewBox="0 0 1440 320" class="w-full">
      <path fill="#ffffff" fill-opacity="1"
        d="M0,224L60,213.3C120,203,240,181,360,181.3C480,181,600,203,720,197.3C840,192,960,160,1080,165.3C1200,171,1320,213,1380,234.7L1440,256L1440,320L1380,320C1320,320,1200,320,1080,320C960,320,840,320,720,320C600,320,480,320,360,320C240,320,120,320,60,320L0,320Z">
      </path>
    </svg>
  </div>
</section>

<script>
  // Mobile menu toggle
  const menuToggle = document.getElementById("menu-toggle");
  const mobileMenu = document.getElementById("mobile-menu");
  const menuClose = document.getElementById("menu-close");

  menuToggle.addEventListener("click", () => {
    mobileMenu.classList.remove("translate-x-full");
  });

  menuClose.addEventListener("click", () => {
    mobileMenu.classList.add("translate-x-full");
  });

  // Click outside to close mobile menu
  document.addEventListener("click", (e) => {
    if (!mobileMenu.contains(e.target) && !menuToggle.contains(e.target)) {
      mobileMenu.classList.add("translate-x-full");
    }
  });

  // Mobile dropdowns - Fixed to work with multiple dropdowns
  const dropdownButtons = document.querySelectorAll(".mobile-dropdown-btn");

  dropdownButtons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const dropdown = btn.nextElementSibling;

      if (dropdown.classList.contains("hidden")) {
        // Close all other dropdowns first
        document.querySelectorAll(".mobile-dropdown").forEach(dd => {
          if (dd !== dropdown) {
            dd.classList.add("hidden");
          }
        });
        dropdown.classList.remove("hidden");
      } else {
        dropdown.classList.add("hidden");
      }
    });
  });

  // Google Sheets Configuration
  const GOOGLE_SHEETS_CONFIG = {
    SHEET_ID: '1I7zPWDzNbq005rfVm8fRIJecIstchdG4cymRX9wjDo0',
    API_KEY: 'AIzaSyDmuM3azTFnGH1fRWQevQPkfQqdtnG6mKU',
    RANGE: 'Sheet1!A:E'
  };

  // Show connection status
  function showStatus(message, isError = false) {
    const statusDiv = document.getElementById('connectionStatus');
    const statusText = document.getElementById('statusText');
    
    statusDiv.className = `mb-4 p-2 rounded ${isError ? 'bg-red-500/20 text-red-200' : 'bg-green-500/20 text-green-200'}`;
    statusText.textContent = message;
    statusDiv.classList.remove('hidden');
    
    // Auto-hide success messages
    if (!isError) {
      setTimeout(() => {
        statusDiv.classList.add('hidden');
      }, 3000);
    }
  }

  // Function to fetch data from Google Sheets
  async function fetchGoogleSheetData(grade) {
    try {
      // Show loading state
      document.getElementById('current-date').textContent = 'Loading...';
      document.getElementById('assignments').textContent = 'Loading...';
      document.getElementById('notices').textContent = 'Loading...';
      
      showStatus('Connecting to Google Sheets...');

      const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_CONFIG.SHEET_ID}/values/${GOOGLE_SHEETS_CONFIG.RANGE}?key=${GOOGLE_SHEETS_CONFIG.API_KEY}`;
      
      const response = await fetch(url);
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const data = await response.json();
      console.log('Google Sheets data:', data); // For debugging
      
      if (data.values && data.values.length > 0) {
        // Skip header row and filter data for the selected grade
        const gradeData = data.values.slice(1).find(row => 
          row[0] && row[0].toLowerCase().trim() === grade.toLowerCase()
        );
        
        if (gradeData && gradeData.length >= 4) {
          // Update dashboard with fetched data
          // Expected format: [Grade, Date, Assignment, Notice, ExtraInfo]
          document.getElementById('current-date').textContent = gradeData[1] || 'No date available';
          document.getElementById('assignments').textContent = gradeData[2] || 'No assignments';
          document.getElementById('notices').textContent = gradeData[3] || 'No notices';
          
          showStatus(`Data loaded successfully for ${grade}`);
        } else {
          // Fallback if no data found for the grade
          showStatus(`No data found for ${grade}`, true);
          displayFallbackData(grade);
        }
      } else {
        showStatus('No data found in spreadsheet', true);
        displayFallbackData(grade);
      }
    } catch (error) {
      console.error('Error fetching Google Sheets data:', error);
      
      let errorMessage = 'Failed to connect to Google Sheets';
      if (error.message.includes('403')) {
        errorMessage = 'API key access denied. Check permissions.';
      } else if (error.message.includes('404')) {
        errorMessage = 'Spreadsheet not found. Check Sheet ID.';
      } else if (error.message.includes('400')) {
        errorMessage = 'Invalid request. Check API key and Sheet ID.';
      }
      
      showStatus(errorMessage, true);
      displayFallbackData(grade);
    }
  }

  // Fallback data when Google Sheets is unavailable
  function displayFallbackData(grade) {
    const now = new Date();
    const options = { 
      weekday: 'long', 
      year: 'numeric', 
      month: 'long', 
      day: 'numeric' 
    };
    const formattedDate = now.toLocaleDateString('en-US', options);
    
    document.getElementById('current-date').textContent = formattedDate;
    document.getElementById('assignments').textContent = `No assignments available for ${grade}`;
    document.getElementById('notices').textContent = 'Please check with your teacher for updates';
  }

  // Load dashboard data based on selected grade
  function loadDashboardData() {
    const selectedClass = document.getElementById('classSelect').value;
    fetchGoogleSheetData(selectedClass);
  }

  // Initialize page
  document.addEventListener('DOMContentLoaded', function() {
    // Load data for initially selected grade
    loadDashboardData();
    
    // Listen for class selection changes
    document.getElementById('classSelect').addEventListener('change', loadDashboardData);
  });

  // Add keyboard navigation for accessibility
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      mobileMenu.classList.add("translate-x-full");
    }
  });

  // Test connection function (can be called from browser console)
  window.testGoogleSheetsConnection = async function() {
    console.log('Testing connection...');
    await fetchGoogleSheetData('grade1');
  };
</script>

</body>

</html>
